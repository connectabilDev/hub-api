# LogTO Environment Variables Documentation

## Authentication Variables (for JWT validation)

These variables are used by the NestJS application to validate JWT tokens from LogTO:

```env
# LogTO Authentication Configuration
LOGTO_DOMAIN=http://localhost:3001                        # The base URL of your LogTO instance
LOGTO_API_RESOURCE_INDICATOR=https://hub-api.connectabil.com  # The unique identifier for your API resource
```

### Explanation:

- **LOGTO_DOMAIN**: The base URL of your LogTO instance (same as LOGTO_ENDPOINT)
- **LOGTO_API_RESOURCE_INDICATOR**: The unique identifier for your API resource in LogTO. This is used as the `audience` when validating JWT tokens.

## Management API Variables (for setup scripts)

These variables are used by the setup scripts to configure LogTO resources via the Management API:

```env
# LogTO Management API Configuration (M2M)
LOGTO_ENDPOINT=http://localhost:3001                      # The base URL of your LogTO instance
LOGTO_TENANT_ID=your-tenant-id                           # Your LogTO tenant ID
LOGTO_M2M_APP_ID=1f00wkpvo1b1ehhz7qf5c                  # Machine-to-Machine app ID from LogTO
LOGTO_M2M_APP_SECRET=D74OMg9amVL8CxH6u2TG9rwNf1Zit07P   # Machine-to-Machine app secret from LogTO
BACKEND_URL=http://localhost:3000                        # Your backend URL for webhook configuration
```

### Explanation:

- **LOGTO_ENDPOINT**: Same as LOGTO_DOMAIN - the base URL of your LogTO instance
- **LOGTO_TENANT_ID**: Your tenant identifier in LogTO
- **LOGTO_M2M_APP_ID**: The ID of the Machine-to-Machine application created in LogTO for management API access
- **LOGTO_M2M_APP_SECRET**: The secret of the M2M application
- **BACKEND_URL**: The URL where your backend is running (used for webhook URLs)

## Webhook Configuration

After running the setup script, you'll receive a webhook signing key:

```env
# Webhook Configuration
LOGTO_WEBHOOK_SIGNING_KEY=cX5Ee5ZaWNgI3J7uKSI9zNDZdwwt6mAm  # Generated by LogTO when creating webhook
```

### Explanation:

- **LOGTO_WEBHOOK_SIGNING_KEY**: Used to verify webhook signatures from LogTO

## Why LOGTO_DOMAIN and LOGTO_ENDPOINT?

Both variables point to the same value (the LogTO instance URL). They exist for different purposes:

1. **LOGTO_DOMAIN**: Used by the authentication module in the application
2. **LOGTO_ENDPOINT**: Used by the setup/configuration scripts

You can consolidate them if desired, but having both provides clarity about their usage context.

## Dynamic Configuration

The `LOGTO_API_RESOURCE_INDICATOR` is now used dynamically throughout the application:

- In the authentication module for JWT validation (as the audience)
- In the setup scripts to create the API resource
- In validation scripts to check configuration

This means you can change the indicator without modifying any hardcoded values in the codebase.
